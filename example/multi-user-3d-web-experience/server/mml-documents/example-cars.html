<m-group id="race-track-group" x="-2.5"></m-group>

<m-group id="info-group" x="-10.5">
  <m-group id="winner" y="0.53" z="4.2" rx="45">
    <m-cube color="#505050" width="4.5" height="0.65" depth="0.1" z="0.06"></m-cube>
    <m-label
      id="winner-label"
      content=""
      ry="180"
      padding="0"
      alignment="center"
      font-color="#eeeeee"
      color="hsl(150, 0%, 30%)"
      width="4.4"
      height="0.5"
      font-size="33"
    ></m-label>
  </m-group>
  <m-group y="0" z="4.3" ry="180">
    <m-label
      id="countdown-label"
      content=""
      padding="0"
      alignment="center"
      font-color="#eeeeee"
      color="hsl(150, 0%, 30%)"
      width="4.4"
      height="2.65"
      font-size="200"
      x="0"
      y="2.23"
      z="-0.099"
      visible="false"
    ></m-label>
  </m-group>

  <m-group id="attributes-label-group" x="0" y="0.5" z="4.5" ry="0">
    <m-model
      y="0.4"
      src="https://mmlstorage.com/fb78bdc93f7d463e7dde14a56535e92ba85336ee9849903193425504ee51ccc0"
      sx="0.4"
      sy="0.4"
      sz="0.4"
    ></m-model>
    <m-group id="code-screen"></m-group>
  </m-group>
</m-group>

<script>
  const raceTrackGroup = document.getElementById("race-track-group");
  const winnerLabel = document.getElementById("winner-label");

  let countDownSound = null;
  let racing = false;

  const raceCars = new Map();
  const raceCarsSound = new Map();

  const carScale = 0.5;
  const trackLength = 30;

  const raceDuration = 3900;
  const raceSoundDuration = 4000;
  const countdownSoundDuration = 4000;

  const easings = ["easeInOutQuad", "easeInOutCubic"];
  const availableCars = ["yellow", "green", "blue", "pink", "red"];
  const availableCarsModels = {
    yellow:
      "https://mmlstorage.com/06a76843d5c29fb1d1ddd89ae059c50dc86e05ef051dfa6798579bfb0f282d32",
    green:
      "https://mmlstorage.com/a0d3025711056c7d8c488de0d704f8dd974f2acd32792822241e7cb17d2bed68",
    blue: "https://mmlstorage.com/56ce286e5c8122ab33500b66584c819430b2d06a47f64530be0e4ae3ed5a1e58",
    pink: "https://mmlstorage.com/bd1fd217082712d542d24d5fcc57d17d1d157e23505f924f4555d5e5095accc5",
    red: "https://mmlstorage.com/71ef0b2deb50c408e4e06069dd1cd6e7ca658c2e06d3ea5e21e9111b2a6bb036",
  };

  const sat = "100%";
  const light = "65%";
  const carColors = [
    `hsl(72, ${sat}, ${light})`,
    `hsl(144, ${sat}, ${light})`,
    `hsl(216, ${sat}, ${light})`,
    `hsl(288, ${sat}, ${light})`,
    `hsl(380, ${sat}, ${light})`,
  ];

  let carIndex = 0;
  let winner = "";
  let winnerIndex = 0;

  const attributesLabelGroup = document.getElementById("attributes-label-group");
  const codeScreen = document.getElementById("code-screen");

  const currentAttributeLabels = new Map();
  const labelWidth = 4.3;
  const labelHeight = 0.26;
  const borderWidth = 0.17;
  const labelsYOffset = 0.8;

  let winnerAnimation = null;

  // interaction buttons ============================================
  class InteractionButton {
    baseModelURL =
      "https://mmlstorage.com/b78b004cfc7c5ba5c0029e6b97d87f1291ad2106e9c724631669684fee295f8d";
    playButtonOnModelURL =
      "https://mmlstorage.com/0e99f1b49eba484ae5a2c447f8ed81bdf893bfb1f2c30160327abf5a69a85b75";
    playButtonOffModelURL =
      "https://mmlstorage.com/0a25bfe85a537917a32dae1f23c442deebc6f4c0594c099a6c576444e8d520a7";
    questionButtonOnModelURL =
      "https://mmlstorage.com/23e1853309eed73d9777043643ca6786c08c787f1de942646b58f238c28795b8";
    questionButtonOffModelURL =
      "https://mmlstorage.com/26180e4f0cf7009c3ed4c82cbde72dadb06424012e09a151951f4a9000ffcd56";
    buttonSoundURL =
      "https://mmlstorage.com/18cf8bddaf0b8dcd93548433637216e3dd086bd3510f00cf83fffc1508932344";

    animDuration = 210;
    buttonSoundDuration = 1200;
    offset = 0.03;
    easing = "easeInOutCubic";

    infoSound = null;
    infoSoundDuration = 0;
    infoSoundCanPlay = true;
    buttonSoundCanPlay = true;

    group = document.createElement("m-group");
    base = document.createElement("m-model");
    buttonOn = document.createElement("m-model");
    buttonOff = document.createElement("m-model");
    buttonSound = document.createElement("m-audio");

    constructor(x, y, z, yRotation, parentGroup) {
      this.base.setAttribute("src", this.baseModelURL);
      this.transform(this.group, x, y, z, yRotation);
      this.group.appendChild(this.base);
      parentGroup.appendChild(this.group);
      this.setupButtonSound();
      return this;
    }

    setupPlay(callBackFunction) {
      this.buttonOn.setAttribute("src", this.playButtonOnModelURL);
      this.buttonOff.setAttribute("src", this.playButtonOffModelURL);
      this.group.appendChild(this.buttonOn);
      this.group.appendChild(this.buttonOff);
      this.scale(this.buttonOff, 0.001);

      this.buttonOn.addEventListener("click", () => {
        this.pushButtonAnim();
        setTimeout(() => {
          this.releaseButtonAnim();
          setTimeout(() => {
            this.turnOff();
            callBackFunction();
          }, this.animDuration + 20);
        }, this.animDuration + 20);

        this.playButtonSound();
      });
    }

    setupInfo(infoSoundURL, infoSoundDuration, infoSoundVolume) {
      this.buttonOn.setAttribute("src", this.questionButtonOnModelURL);
      this.buttonOff.setAttribute("src", this.questionButtonOffModelURL);
      this.group.appendChild(this.buttonOn);
      this.group.appendChild(this.buttonOff);
      this.scale(this.buttonOff, 0.001);

      this.infoSound = document.createElement("m-audio");
      this.infoSound.setAttribute("y", 12);
      this.infoSound.setAttribute("rx", 90);
      this.infoSound.setAttribute("cone-angle", 90);
      this.infoSound.setAttribute("cone-falloff-angle", 120);
      this.infoSound.setAttribute("loop", false);
      this.infoSound.setAttribute("debug", false);
      this.infoSound.setAttribute("src", infoSoundURL);
      this.infoSound.setAttribute("volume", 0);
      this.infoSound.setAttribute("start-time", document.timeline.currentTime - infoSoundDuration);
      this.infoSound.setAttribute("pause-time", document.timeline.currentTime);
      this.group.appendChild(this.infoSound);

      this.buttonOn.addEventListener("click", () => {
        this.pushButtonAnim();
        setTimeout(() => {
          this.releaseButtonAnim();
          setTimeout(() => {
            this.turnOff();
            setTimeout(() => this.turnOn(), infoSoundDuration);
          }, this.animDuration + 20);
        }, this.animDuration + 20);

        this.playButtonSound();
        setTimeout(() => {
          this.playInfoSound(infoSoundDuration, infoSoundVolume);
        }, this.buttonSoundDuration * 0.6667);
      });
    }

    turnOff() {
      this.swap(this.buttonOn, this.buttonOff);
    }

    turnOn() {
      this.swap(this.buttonOff, this.buttonOn);
    }

    pushButtonAnim() {
      this.animateButton(this.buttonOn, "y", 0, -this.offset, this.animDuration, this.easing);
      this.animateButton(this.buttonOn, "z", 0, this.offset, this.animDuration, this.easing);
    }

    releaseButtonAnim() {
      this.animateButton(this.buttonOn, "y", -this.offset, 0, this.animDuration, this.easing);
      this.animateButton(this.buttonOn, "z", this.offset, 0, this.animDuration, this.easing);
    }

    playInfoSound(infoSoundDuration, infoSoundVolume) {
      if (this.infoSoundCanPlay === false || this.infoSound === null) {
        return;
      }
      this.infoSoundCanPlay = false;
      const now = document.timeline.currentTime;
      this.infoSound.setAttribute("volume", infoSoundVolume);
      this.infoSound.setAttribute("start-time", now);
      this.infoSound.setAttribute("pause-time", now + infoSoundDuration);
      setTimeout(() => {
        this.infoSound.setAttribute("volume", 0);
        this.infoSoundCanPlay = true;
      }, infoSoundDuration);
    }

    playButtonSound() {
      if (this.buttonSoundCanPlay === false) {
        return;
      }
      this.buttonSoundCanPlay === false;
      const now = document.timeline.currentTime;
      this.buttonSound.setAttribute("volume", 2);
      this.buttonSound.setAttribute("start-time", now);
      this.buttonSound.setAttribute("pause-time", now + this.buttonSoundDuration);
      setTimeout(() => {
        this.buttonSound.setAttribute("volume", 0);
        this.buttonSoundCanPlay === true;
      }, this.buttonSoundDuration);
    }

    transform(element, x, y, z, ry) {
      element.setAttribute("x", x);
      element.setAttribute("y", y);
      element.setAttribute("z", z);
      element.setAttribute("ry", ry);
    }

    scale(element, size) {
      element.setAttribute("sx", size);
      element.setAttribute("sy", size);
      element.setAttribute("sz", size);
    }

    swap(elementA, elementB) {
      this.scale(elementB, 1.0);
      this.scale(elementA, 0.001);
    }

    setupButtonSound() {
      this.buttonSound.setAttribute("y", 1.2);
      this.buttonSound.setAttribute("loop", false);
      this.buttonSound.setAttribute("debug", false);
      this.buttonSound.setAttribute(
        "src",
        "https://mmlstorage.com/18cf8bddaf0b8dcd93548433637216e3dd086bd3510f00cf83fffc1508932344",
      );
      this.buttonSound.setAttribute("volume", 0);
      this.buttonSound.setAttribute("start-time", document.timeline.currentTime - 900);
      this.buttonSound.setAttribute("pause-time", document.timeline.currentTime);
      this.group.appendChild(this.buttonSound);
    }

    animateButton(element, attr, start, end, duration, easing) {
      const buttonAnim = document.createElement("m-attr-anim");
      buttonAnim.setAttribute("attr", attr);
      buttonAnim.setAttribute("start", start);
      buttonAnim.setAttribute("end", end);
      buttonAnim.setAttribute("start-time", document.timeline.currentTime);
      buttonAnim.setAttribute("end-time", document.timeline.currentTime + duration);
      buttonAnim.setAttribute("duration", duration);
      buttonAnim.setAttribute("easing", easing);
      buttonAnim.setAttribute("loop", false);
      element.appendChild(buttonAnim);
      setTimeout(() => {
        element.setAttribute(attr, end);
        element.removeChild(buttonAnim);
      }, duration);
    }
  }

  const infoButton = new InteractionButton(-8, 0, -1.5, 0, raceTrackGroup);
  infoButton.setupInfo(
    "https://mmlstorage.com/d1202953ab0f39d7eb634c625fc657f002c369ffaaa378fbfe9b3e59bd201b67",
    4500,
    3,
  );
  const playButton = new InteractionButton(-8.5, 0, -1.5, 0, raceTrackGroup);
  playButton.setupPlay(play);
  // ================================================================

  // code display ===================================================
  class CodeDisplay {
    currentAttributeLabels = new Map();
    totalLines = 0;

    /**
     * Creates an instance of CodeDisplay.
     * @param {Object} config Configuration object for the CodeDisplay.
     * @param {number} config.x The x position of the display panel.
     * @param {number} config.y The y position of the display panel.
     * @param {number} config.z The z position of the display panel.
     * @param {number} config.width The width of the display panel.
     * @param {number} config.height The height of the display panel.
     * @param {number} config.depth The depth of the display panel.
     * @param {string} config.bgColor The background color.
     * @param {string} config.fgColor The foreground color.
     * @param {number} config.textWidth The width of each text line.
     * @param {number} config.textHeight The height of each text line.
     * @param {number} config.fontSize The font size for the text.
     * @param {HTMLElement} config.parentElement The parent element to which the panel will be appended.
     */
    constructor({
      x,
      y,
      z,
      width,
      height,
      depth,
      bgColor,
      fgColor,
      textWidth,
      textHeight,
      fontSize,
      parentElement,
    }) {
      this.panel = document.createElement("m-cube");
      this.x = x;
      this.y = y;
      this.z = z;
      this.width = width;
      this.height = height;
      this.depth = depth;
      this.bgColor = bgColor;
      this.fgColor = fgColor;
      this.textWidth = textWidth;
      this.textHeight = textHeight;
      this.fontSize = fontSize;
      this.parentElement = parentElement;
      this.bigFontLabel = document.createElement("m-label");

      this.panel.setAttribute("width", this.width);
      this.panel.setAttribute("height", this.height);
      this.panel.setAttribute("depth", this.depth);
      this.panel.setAttribute("color", this.bgColor);
      this.panel.setAttribute("x", this.x);
      this.panel.setAttribute("y", this.height / 2 + this.y);
      this.panel.setAttribute("z", -this.depth / 2 - 0.01 + this.z);
      this.panel.setAttribute("ry", 180);
      this.parentElement.appendChild(this.panel);
    }

    createLabel(index, str) {
      if (str.includes("/assets/playground/")) {
        str = str.replace("/assets/playground/", "https://mml.io/");
      }
      const y = this.totalLines * this.textHeight - index * this.textHeight;
      const yOffset = ((this.totalLines + 0.5) * this.textHeight) / 2;
      const firstOrLast = index === this.totalLines - 1 || index === 0;
      const text = firstOrLast ? ` ${str}` : `    ${str}`;
      const label = document.createElement("m-label");
      label.setAttribute("font-size", this.fontSize);
      label.setAttribute("color", this.bgColor);
      label.setAttribute("content", text);
      label.setAttribute("padding", 0);
      label.setAttribute("alignment", "left");
      label.setAttribute("font-color", this.fgColor);
      label.setAttribute("width", this.textWidth);
      label.setAttribute("height", this.textHeight);
      label.setAttribute("emissive", 4);
      label.setAttribute("y", y - yOffset);
      label.setAttribute("z", this.depth / 2 + 0.01);
      return label;
    }

    createLabels(attributes) {
      this.totalLines = attributes.length;
      this.currentAttributeLabels.forEach((label) => this.panel.removeChild(label));
      this.currentAttributeLabels.clear();
      for (let i = 0; i < attributes.length; i++) {
        const label = this.createLabel(i, attributes[i]);
        this.currentAttributeLabels.set(i, label);
        this.panel.appendChild(label);
      }
    }

    setTextColor(color) {
      this.fgColor = color;
    }

    setPanelTextFromAttributes(element, tagOpen, tagClose) {
      const attributes = [];
      for (const attr of element.getAttributeNames()) {
        let val = element.getAttribute(attr);
        const numberVal = parseFloat(val);
        if (!isNaN(numberVal)) val = numberVal.toFixed(2);
        attributes.push(`${attr}="${val}"`);
      }
      attributes.unshift(tagOpen);
      attributes.push(tagClose);
      this.createLabels(attributes);
    }

    setBigFontText(str, fontSize, color = "#aaaaaa") {
      this.bigFontLabel.setAttribute("x", -0.05);
      this.bigFontLabel.setAttribute("z", this.depth / 2 + 0.03);
      this.bigFontLabel.setAttribute("content", str);
      this.bigFontLabel.setAttribute("font-size", fontSize);
      this.bigFontLabel.setAttribute("color", this.bgColor);
      this.bigFontLabel.setAttribute("padding", 0);
      this.bigFontLabel.setAttribute("alignment", "center");
      this.bigFontLabel.setAttribute("font-color", color);
      this.bigFontLabel.setAttribute("width", this.width);
      this.bigFontLabel.setAttribute("height", this.height);
      this.bigFontLabel.setAttribute("emissive", 4);
      this.panel.appendChild(this.bigFontLabel);
    }

    clearBigFontText() {
      this.panel.removeChild(this.bigFontLabel);
    }
  }
  const codeDisplay = new CodeDisplay({
    x: 0.25,
    y: 0.85,
    z: 0.11,
    width: 3.9,
    height: 2,
    depth: 0.1,
    bgColor: "#000000",
    fgColor: "#00ff41",
    textWidth: 3.5,
    textHeight: 0.2,
    fontSize: 17,
    parentElement: codeScreen,
  });

  // auxiliary functions ======================================================
  function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function getRandomElement(array) {
    const randomIndex = Math.floor(Math.random() * array.length);
    return array[randomIndex];
  }

  function animate(element, attr, start, end, duration, easing) {
    const anim = document.createElement("m-attr-anim");
    anim.setAttribute("attr", attr);
    anim.setAttribute("start", start);
    anim.setAttribute("end", end);
    anim.setAttribute("start-time", document.timeline.currentTime);
    anim.setAttribute("end-time", document.timeline.currentTime + duration);
    anim.setAttribute("duration", duration);
    anim.setAttribute("easing", easing);
    anim.setAttribute("loop", false);
    element.appendChild(anim);
    setTimeout(() => {
      element.setAttribute(attr, end);
      element.removeChild(anim);
    }, duration);
    return anim;
  }

  function highlightElement(element) {
    const color = element.getAttribute("color");
    const hue = parseInt(color.replace("hsl(", "").split(",")[0]);
    element.setAttribute("color", `hsl(${hue}, 90%, 80%)`);
    setTimeout(() => element.setAttribute("color", color), 160);
  }
  // ==========================================================================

  function createCountDownSound() {
    countDownSound = document.createElement("m-audio");
    countDownSound.setAttribute(
      "src",
      "https://mmlstorage.com/3a3097b651169f68b56dd3d844e1f2eb773b6b49f248cc2b3b9e6c13d6e6f3e2",
    );
    countDownSound.setAttribute("loop", false);
    countDownSound.setAttribute("start-time", document.timeline.currentTime - 4100);
    countDownSound.setAttribute("pause-time", document.timeline.currentTime - 100);
    countDownSound.setAttribute("volume", 0);
    raceTrackGroup.appendChild(countDownSound);
  }

  function createTrack() {
    const track = document.createElement("m-cube");
    track.setAttribute("color", "#424242");
    track.setAttribute("width", trackLength);
    track.setAttribute("height", 0.1);
    track.setAttribute("depth", carScale * 10);
    track.setAttribute("y", 0.25);
    track.setAttribute("z", carScale * 3.1);
    checkered = document.createElement("m-image");
    checkered.setAttribute("color", "#ffffff");
    checkered.setAttribute("src", "/assets/playground/checkered.jpg");
    checkered.setAttribute("width", carScale * 10);
    checkered.setAttribute("height", 1.7);
    checkered.setAttribute("x", trackLength / 2 - 1.4);
    checkered.setAttribute("y", 0.065);
    checkered.setAttribute("rx", -90);
    checkered.setAttribute("rz", 90);
    checkered.setAttribute("opacity", 0.3);
    track.appendChild(checkered);
    raceTrackGroup.appendChild(track);
  }

  function createRacingSound(xPos, yPos, zPos) {
    const now = document.timeline.currentTime;
    const racingSound = document.createElement("m-audio");
    racingSound.setAttribute(
      "src",
      "https://mmlstorage.com/80034cf5936b214055dd3228556a536f43c407b9d563f2b8f0324f360a01a432",
    );
    racingSound.setAttribute("loop", false);
    racingSound.setAttribute("start-time", now - raceSoundDuration - 100);
    racingSound.setAttribute("pause-time", now - 100);
    racingSound.setAttribute("volume", 0);
    racingSound.setAttribute("x", xPos);
    racingSound.setAttribute("y", yPos);
    racingSound.setAttribute("z", zPos);
    return racingSound;
  }

  function createCars() {
    while (carIndex < availableCars.length) {
      const xPos = -trackLength / 2 + 1;
      const yPos = 0.3;
      const zPos = carIndex * carScale * 2 - carScale * 0.75;

      if (!raceCarsSound.has(carIndex)) {
        raceCarsSound.set(carIndex, createRacingSound([xPos, yPos, zPos]));
      }

      const carColor = availableCars[carIndex];
      const carURL = availableCarsModels[carColor];
      const carSound = raceCarsSound.get(carIndex);

      const car = document.createElement("m-model");
      car.setAttribute("src", carURL);
      car.setAttribute("anim", carURL);
      car.setAttribute("anim-enabled", false);
      car.setAttribute("sx", carScale);
      car.setAttribute("sy", carScale);
      car.setAttribute("sz", carScale);
      car.setAttribute("x", xPos);
      car.setAttribute("y", yPos);
      car.setAttribute("z", zPos);
      car.setAttribute("collide", false);
      raceCars.set(carIndex, car);

      raceTrackGroup.appendChild(car);
      raceTrackGroup.appendChild(carSound);
      carIndex++;
    }
  }

  function playCountdownSound() {
    const now = document.timeline.currentTime;
    countDownSound.setAttribute("start-time", now);
    countDownSound.removeAttribute("pause-time");
    countDownSound.setAttribute("volume", 1);
    setTimeout(() => {
      countDownSound.setAttribute("pause-time", now);
      countDownSound.setAttribute("volume", 0);
    }, countdownSoundDuration);
    setTimeout(() => {
      codeDisplay.setBigFontText("3", 150, "#999999");
      setTimeout(() => codeDisplay.setBigFontText("2", 150, "#999999"), 1000);
      setTimeout(() => codeDisplay.setBigFontText("1", 150, "#999999"), 2000);
      setTimeout(() => codeDisplay.setBigFontText("GO", 150, "#99ff99"), 2750);
    }, 500);
  }

  function playCarSound(carIndex, time) {
    const now = document.timeline.currentTime;
    const timeOffset = raceDuration - time;
    const sound = raceCarsSound.get(carIndex);
    sound.setAttribute("start-time", now + timeOffset);
    sound.setAttribute("pause-time", now + timeOffset + raceSoundDuration);
    sound.setAttribute("volume", 1);
    const startX = -trackLength / 2 + 1;
    const endX = trackLength / 2 - 1.5;
    animate(sound, "x", startX, endX, time, getRandomElement(easings));
  }

  function stopCarSound(carIndex) {
    const now = document.timeline.currentTime;
    const sound = raceCarsSound.get(carIndex);
    sound.setAttribute("volume", 0);
    sound.setAttribute("start-time", now - raceSoundDuration - 100);
    sound.setAttribute("pause-time", now - 100);
  }

  function updateAttributesLabel(color) {
    codeDisplay.clearBigFontText();
    codeDisplay.setTextColor(color);
    codeDisplay.setPanelTextFromAttributes(winnerAnimation, "<m-attr-anim", "></m-attr-anim>");
  }

  function startRace() {
    let smallestTime = 999999999;
    const startX = -trackLength / 2 + 1;
    const endX = trackLength / 2 - 1.5;
    raceCars.forEach((car, index) => {
      const time = getRandomInt(raceDuration - raceDuration * 0.1, raceDuration);
      const easing = getRandomElement(easings);
      const sound = raceCarsSound.get(index);
      car.setAttribute("anim-enabled", true);
      car.setAttribute("anim-loop", true);
      car.setAttribute("anim-start-time", document.timeline.currentTime);
      car.removeAttribute("anim-pause-time");
      const animation = animate(car, "x", startX, endX, time, easing);
      if (time < smallestTime) {
        smallestTime = time;
        winner = `Winner: ${availableCars[index]} (${(time / 1000).toFixed(3)}s)`;
        winnerAnimation = animation;
        winnerIndex = index;
      }
      playCarSound(index, time);
      setTimeout(() => {
        racing = false;
        car.setAttribute("anim-enabled", false);
        car.setAttribute("anim-loop", false);
        car.setAttribute("anim-start-time", document.timeline.currentTime - 1000);
        car.setAttribute("anim-pause-time", document.timeline.currentTime);

        stopCarSound(index);
        const winnerLabelContent = winnerLabel.getAttribute("content");
        if (winnerLabelContent !== winner) {
          winnerLabel.setAttribute("content", winner);
          updateAttributesLabel(carColors[winnerIndex]);
        }
        if (playButton) {
          playButton.turnOn();
        }
      }, time);
    });
  }

  createCountDownSound();
  createTrack();
  createCars();

  function play() {
    if (racing) return;
    racing = true;
    winnerLabel.setAttribute("content", "");
    raceCars.forEach((car) => {
      car.setAttribute("x", -trackLength / 2 + 1);
    });
    playCountdownSound();
    setTimeout(() => {
      startRace();
    }, 3200);
  }
</script>
